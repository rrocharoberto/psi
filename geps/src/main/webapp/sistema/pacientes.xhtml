<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"	
	xmlns:format="customTagLib/LocalDateTimeConverter">

<h:head>
</h:head>

<ui:composition template="/template/layoutBase.xhtml">
	
	<ui:define name="content">
	
		<p:dialog header="Editar paciente" 
				  id="dialog-modal-editar-paciente" 
		   		  widgetVar="dialog-modal-editar-paciente" 
		   		  modal="true" 
		   		  height="400px"
		   		  width="550px">
			<h:form id="form-dados-paciente">
				<ui:include src="/sistema/editarPaciente.xhtml"/>
				<p:commandButton value="Alterar" 
								id="commandButton-alterar"
								icon="ui-icon-gear"
								actionListener="#{pacienteController.atualizarPaciente}"
								oncomplete="PF('dialog-modal-editar-paciente').hide();"/> 
	 		 
			</h:form>    			
		</p:dialog>

		<p:dialog header="Prontuário: #{prontuarioController.currentProntuario.numeroProntuario} 
							Paciente: #{prontuarioController.currentProntuario.paciente.dadosPessoais.nome}" 
				  id="dialog-modal-prontuario" 
		   		  widgetVar="dialog-modal-prontuario" 
		   		  modal="true" 
		   		  height="500px"
		   		  width="750px">
		   		      		    		
    		 <ui:include src="/sistema/prontuario.xhtml"/>
    		 
    		 <p:ajax event="close" update="form-consulta-paciente" />
		</p:dialog>
		
<!-- 
		<p:dialog header="Acompanhamento do paciente: #{prontuarioController.currentProntuario.paciente.dadosPessoais.nome}" 
				  id="dialog-modal-acompanhar" 
		   		  widgetVar="dialog-modal-acompanhar" 
		   		  modal="true" 
		   		  height="500px"
		   		  width="750px">
		   		      		    		
    		 <ui:include src="/sistema/acompanhamento.xhtml"/>
		</p:dialog>
 -->
		<h:form style="margin:auto;margin:1%;" id="form-consulta-paciente">
			
			<h:panelGrid id="panelGrid-campos-form" columns="1" cellpadding="10">
			<p:dataTable id="dataTable-registros"
						 var="paciente" 
						 value="#{consultarPacienteController.pacientes}" 
						 rows="15"
						 paginator="true"
						 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="5,10,15"
                         rowStyleClass="#{paciente.dataSaida != null ? 'old' : null}">
			
				<p:column headerText="CPF" style="width:100px;">
					<h:outputText value="#{paciente.cpf}" converter="CPFConverter"/>
				</p:column>
				
				<p:column headerText="Nome">
					<h:outputText value="#{paciente.dadosPessoais.nome}" />
				</p:column>
				
				<p:column headerText="Declaração" style="width:80px;">
					<h:outputText styleClass="#{empty paciente.prontuario.declaracao ? 'warning' : null}"
								value="#{empty paciente.prontuario.declaracao ? 'Não enviado' : 'Ok'}" />
				</p:column>
				<p:column headerText="Termo" style="width:80px;">
					<h:outputText styleClass="#{empty paciente.prontuario.termoConsentimento ? 'warning' : null}"
								value="#{empty paciente.prontuario.termoConsentimento ? 'Não enviado' : 'Ok'}" />
				</p:column>
				
				<p:column headerText="Data Entrada" style="width:80px;">
					<h:outputFormat id="dataEntrada" value="{0,date,dd/MM/yyyy}">
						<f:param value="#{paciente.dataEntrada}"/>
					</h:outputFormat>
				</p:column>

				<p:column headerText="Data Saída" style="width:80px;">
					<h:outputText rendered="#{paciente.dataSaida == null}" value="-" />
					<h:outputFormat id="dataSaida" rendered="#{paciente.dataSaida != null}" value="{0,date,dd/MM/yyyy}">
						<f:param value="#{paciente.dataSaida}"/>
					</h:outputFormat>
				</p:column>
				
				<p:column headerText="Editar" style="width:35px;">
				
					<p:commandButton icon="fa fa-pencil" 
									title="Editar Paciente"    
									style="horizontal-align:center;"
									ajax="true"                        					 
									actionListener="#{pacienteController.editar(paciente)}"
									oncomplete="PF('dialog-modal-editar-paciente').show();" 
									update="dialog-modal-editar-paciente"/>
				</p:column>

				<p:column headerText="Prontuário" style="width:70px;">
					<p:commandButton icon="fa fa-file-text-o" 
									title="Abrir Prontuário"                        					 
									style="horizontal-align:center;"
									ajax="true"
									actionListener="#{prontuarioController.abrirProntuario(paciente)}"
									oncomplete="PF('dialog-modal-prontuario').show();" 
									update="dialog-modal-prontuario"/>
				</p:column>

<!-- 
				<p:column headerText="Acompanhar" style="width:80px;">
				
				<p:commandButton icon="fa fa-mail-forward" 
								title="Acompanhar paciente"
								style="horizontal-align:center;"
								ajax="true"
								actionListener="#{prontuarioController.acompanhar(paciente)}"
								oncomplete="PF('dialog-modal-acompanhar').show();" 
								update="dialog-modal-acompanhar"/>
				    
				</p:column>
        				 
 -->
			</p:dataTable>
			</h:panelGrid>
		</h:form>
	</ui:define>
</ui:composition>
</html>